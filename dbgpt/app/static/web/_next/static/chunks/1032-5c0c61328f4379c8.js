"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1032,9549],{45766:function(e,l,t){t.d(l,{Z:function(){return i}});var n=t(34548),r=t(38497),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},o=t(66956),i=r.forwardRef(function(e,l){return r.createElement(o.Z,(0,n.Z)({},e,{ref:l,icon:a}))})},25670:function(e,l,t){t.d(l,{Z:function(){return i}});var n=t(34548),r=t(38497),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},o=t(66956),i=r.forwardRef(function(e,l){return r.createElement(o.Z,(0,n.Z)({},e,{ref:l,icon:a}))})},670:function(e,l,t){t.d(l,{Z:function(){return i}});var n=t(34548),r=t(38497),a={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"},o=t(66956),i=r.forwardRef(function(e,l){return r.createElement(o.Z,(0,n.Z)({},e,{ref:l,icon:a}))})},22027:function(e,l,t){t.d(l,{Z:function(){return i}});var n=t(34548),r=t(38497),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M484 443.1V528h-84.5c-4.1 0-7.5 3.1-7.5 7v42c0 3.8 3.4 7 7.5 7H484v84.9c0 3.9 3.2 7.1 7 7.1h42c3.9 0 7-3.2 7-7.1V584h84.5c4.1 0 7.5-3.2 7.5-7v-42c0-3.9-3.4-7-7.5-7H540v-84.9c0-3.9-3.1-7.1-7-7.1h-42c-3.8 0-7 3.2-7 7.1zm396-144.7H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder-add",theme:"outlined"},o=t(66956),i=r.forwardRef(function(e,l){return r.createElement(o.Z,(0,n.Z)({},e,{ref:l,icon:a}))})},81736:function(e,l,t){t.d(l,{Z:function(){return i}});var n=t(34548),r=t(38497),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},o=t(66956),i=r.forwardRef(function(e,l){return r.createElement(o.Z,(0,n.Z)({},e,{ref:l,icon:a}))})},48323:function(e,l,t){t.d(l,{Z:function(){return i}});var n=t(34548),r=t(38497),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"},o=t(66956),i=r.forwardRef(function(e,l){return r.createElement(o.Z,(0,n.Z)({},e,{ref:l,icon:a}))})},96434:function(e,l,t){t.d(l,{Z:function(){return i}});var n=t(34548),r=t(38497),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M931.4 498.9L94.9 79.5c-3.4-1.7-7.3-2.1-11-1.2a15.99 15.99 0 00-11.7 19.3l86.2 352.2c1.3 5.3 5.2 9.6 10.4 11.3l147.7 50.7-147.6 50.7c-5.2 1.8-9.1 6-10.3 11.3L72.2 926.5c-.9 3.7-.5 7.6 1.2 10.9 3.9 7.9 13.5 11.1 21.5 7.2l836.5-417c3.1-1.5 5.6-4.1 7.2-7.1 3.9-8 .7-17.6-7.2-21.6zM170.8 826.3l50.3-205.6 295.2-101.3c2.3-.8 4.2-2.6 5-5 1.4-4.2-.8-8.7-5-10.2L221.1 403 171 198.2l628 314.9-628.2 313.2z"}}]},name:"send",theme:"outlined"},o=t(66956),i=r.forwardRef(function(e,l){return r.createElement(o.Z,(0,n.Z)({},e,{ref:l,icon:a}))})},84245:function(e,l,t){t.d(l,{Z:function(){return i}});var n=t(34548),r=t(38497),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8zM872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"swap",theme:"outlined"},o=t(66956),i=r.forwardRef(function(e,l){return r.createElement(o.Z,(0,n.Z)({},e,{ref:l,icon:a}))})},40144:function(e,l,t){var n=t(69336),r=t(38497),a=t(90232);l.Z=function(e,l){(0,r.useEffect)(function(){var l=e(),t=!1;return!function(){(0,n.mG)(this,void 0,void 0,function(){return(0,n.Jh)(this,function(e){switch(e.label){case 0:if(!(0,a.mf)(l[Symbol.asyncIterator]))return[3,4];e.label=1;case 1:return[4,l.next()];case 2:if(e.sent().done||t)return[3,3];return[3,1];case 3:return[3,6];case 4:return[4,l];case 5:e.sent(),e.label=6;case 6:return[2]}})})}(),function(){t=!0}},l)}},48218:function(e,l,t){t.d(l,{Z:function(){return k}});var n=t(38497),r=t(26869),a=t.n(r),o=t(61060),i=t(93226),s=t(13785),c=t(12719),u=t(54534);let d=["wrap","nowrap","wrap-reverse"],f=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],m=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],v=(e,l)=>{let t=!0===l.wrap?"wrap":l.wrap;return{[`${e}-wrap-${t}`]:t&&d.includes(t)}},p=(e,l)=>{let t={};return m.forEach(n=>{t[`${e}-align-${n}`]=l.align===n}),t[`${e}-align-stretch`]=!l.align&&!!l.vertical,t},h=(e,l)=>{let t={};return f.forEach(n=>{t[`${e}-justify-${n}`]=l.justify===n}),t},x=e=>{let{componentCls:l}=e;return{[l]:{display:"flex",margin:0,padding:0,"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},g=e=>{let{componentCls:l}=e;return{[l]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},b=e=>{let{componentCls:l}=e,t={};return d.forEach(e=>{t[`${l}-wrap-${e}`]={flexWrap:e}}),t},y=e=>{let{componentCls:l}=e,t={};return m.forEach(e=>{t[`${l}-align-${e}`]={alignItems:e}}),t},j=e=>{let{componentCls:l}=e,t={};return f.forEach(e=>{t[`${l}-justify-${e}`]={justifyContent:e}}),t};var w=(0,c.I$)("Flex",e=>{let{paddingXS:l,padding:t,paddingLG:n}=e,r=(0,u.IX)(e,{flexGapSM:l,flexGap:t,flexGapLG:n});return[x(r),g(r),b(r),y(r),j(r)]},()=>({}),{resetStyle:!1}),_=function(e,l){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>l.indexOf(n)&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>l.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]]);return t};let C=n.forwardRef((e,l)=>{let{prefixCls:t,rootClassName:r,className:c,style:u,flex:d,gap:f,children:m,vertical:x=!1,component:g="div"}=e,b=_(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:y,direction:j,getPrefixCls:C}=n.useContext(s.E_),k=C("flex",t),[Z,N,S]=w(k),E=null!=x?x:null==y?void 0:y.vertical,$=a()(c,r,null==y?void 0:y.className,k,N,S,a()(Object.assign(Object.assign(Object.assign({},v(k,e)),p(k,e)),h(k,e))),{[`${k}-rtl`]:"rtl"===j,[`${k}-gap-${f}`]:(0,i.n)(f),[`${k}-vertical`]:E}),O=Object.assign(Object.assign({},null==y?void 0:y.style),u);return d&&(O.flex=d),f&&!(0,i.n)(f)&&(O.gap=f),Z(n.createElement(g,Object.assign({ref:l,className:$,style:O},(0,o.Z)(b,["justify","wrap","align"])),m))});var k=C},86250:function(e,l,t){t.d(l,{Z:function(){return $}});var n=t(38497),r=t(26869),a=t.n(r),o=t(61060),i=t(31343),s=t(33720),c=t(33537),u=t(21460),d=t(13785),f=t(85929),m=t(80994),v=t(21072),p=t(54534),h=t(12719);let x=e=>{let{paddingXXS:l,lineWidth:t,tagPaddingHorizontal:n,componentCls:r,calc:a}=e,o=a(n).sub(t).equal(),i=a(l).sub(t).equal();return{[r]:Object.assign(Object.assign({},(0,v.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:o,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,f.bf)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${r}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${r}-close-icon`]:{marginInlineStart:i,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${r}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${r}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:o}}),[`${r}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},g=e=>{let{lineWidth:l,fontSizeIcon:t,calc:n}=e,r=e.fontSizeSM,a=(0,p.IX)(e,{tagFontSize:r,tagLineHeight:(0,f.bf)(n(e.lineHeightSM).mul(r).equal()),tagIconSize:n(t).sub(n(l).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg});return a},b=e=>({defaultBg:new m.t(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var y=(0,h.I$)("Tag",e=>{let l=g(e);return x(l)},b),j=function(e,l){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>l.indexOf(n)&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>l.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]]);return t};let w=n.forwardRef((e,l)=>{let{prefixCls:t,style:r,className:o,checked:i,onChange:s,onClick:c}=e,u=j(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:f,tag:m}=n.useContext(d.E_),v=f("tag",t),[p,h,x]=y(v),g=a()(v,`${v}-checkable`,{[`${v}-checkable-checked`]:i},null==m?void 0:m.className,o,h,x);return p(n.createElement("span",Object.assign({},u,{ref:l,style:Object.assign(Object.assign({},r),null==m?void 0:m.style),className:g,onClick:e=>{null==s||s(!i),null==c||c(e)}})))});var _=t(58096);let C=e=>(0,_.Z)(e,(l,t)=>{let{textColor:n,lightBorderColor:r,lightColor:a,darkColor:o}=t;return{[`${e.componentCls}${e.componentCls}-${l}`]:{color:n,background:a,borderColor:r,"&-inverse":{color:e.colorTextLightSolid,background:o,borderColor:o},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}});var k=(0,h.bk)(["Tag","preset"],e=>{let l=g(e);return C(l)},b);let Z=(e,l,t)=>{let n=function(e){if("string"!=typeof e)return e;let l=e.charAt(0).toUpperCase()+e.slice(1);return l}(t);return{[`${e.componentCls}${e.componentCls}-${l}`]:{color:e[`color${t}`],background:e[`color${n}Bg`],borderColor:e[`color${n}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}};var N=(0,h.bk)(["Tag","status"],e=>{let l=g(e);return[Z(l,"success","Success"),Z(l,"processing","Info"),Z(l,"error","Error"),Z(l,"warning","Warning")]},b),S=function(e,l){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>l.indexOf(n)&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>l.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]]);return t};let E=n.forwardRef((e,l)=>{let{prefixCls:t,className:r,rootClassName:f,style:m,children:v,icon:p,color:h,onClose:x,bordered:g=!0,visible:b}=e,j=S(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:w,direction:_,tag:C}=n.useContext(d.E_),[Z,E]=n.useState(!0),$=(0,o.Z)(j,["closeIcon","closable"]);n.useEffect(()=>{void 0!==b&&E(b)},[b]);let O=(0,i.o2)(h),M=(0,i.yT)(h),R=O||M,z=Object.assign(Object.assign({backgroundColor:h&&!R?h:void 0},null==C?void 0:C.style),m),I=w("tag",t),[V,P,H]=y(I),L=a()(I,null==C?void 0:C.className,{[`${I}-${h}`]:R,[`${I}-has-color`]:h&&!R,[`${I}-hidden`]:!Z,[`${I}-rtl`]:"rtl"===_,[`${I}-borderless`]:!g},r,f,P,H),T=e=>{e.stopPropagation(),null==x||x(e),e.defaultPrevented||E(!1)},[,B]=(0,s.Z)((0,s.w)(e),(0,s.w)(C),{closable:!1,closeIconRender:e=>{let l=n.createElement("span",{className:`${I}-close-icon`,onClick:T},e);return(0,c.wm)(e,l,e=>({onClick:l=>{var t;null===(t=null==e?void 0:e.onClick)||void 0===t||t.call(e,l),T(l)},className:a()(null==e?void 0:e.className,`${I}-close-icon`)}))}}),A="function"==typeof j.onClick||v&&"a"===v.type,D=p||null,F=D?n.createElement(n.Fragment,null,D,v&&n.createElement("span",null,v)):v,W=n.createElement("span",Object.assign({},$,{ref:l,className:L,style:z}),F,B,O&&n.createElement(k,{key:"preset",prefixCls:I}),M&&n.createElement(N,{key:"status",prefixCls:I}));return V(A?n.createElement(u.Z,{component:"Tag"},W):W)});E.CheckableTag=w;var $=E},51310:function(e,l,t){var n=t(88506);l.Z=()=>{var e;return JSON.parse(null!==(e=localStorage.getItem(n.C9))&&void 0!==e?e:"")}},61977:function(e,l,t){var n=t(96469),r=t(27250),a=t(23852),o=t.n(a),i=t(38497);l.Z=(0,i.memo)(e=>{let{width:l,height:t,model:a}=e,s=(0,i.useMemo)(()=>{let e=null==a?void 0:a.replaceAll("-","_").split("_")[0],l=Object.keys(r.Me);for(let t=0;t<l.length;t++){let n=l[t];if(null==e?void 0:e.includes(n))return r.Me[n]}return"/models/huggingface.svg"},[a]);return a?(0,n.jsx)(o(),{className:"rounded-full border border-gray-200 object-contain bg-white inline-block",width:l||24,height:t||24,src:s,alt:"llm",priority:!0}):null})},67661:function(e,l,t){var n=t(96469),r=t(67901),a=t(55763),o=t(38497);l.Z=e=>{let{width:l,height:t,scene:i}=e,s=(0,o.useCallback)(()=>{switch(i){case"chat_knowledge":return r.je;case"chat_with_db_execute":return r.zM;case"chat_excel":return r.DL;case"chat_with_db_qa":case"chat_dba":return r.RD;case"chat_dashboard":return r.In;case"chat_agent":return r.si;case"chat_normal":return r.O7;default:return}},[i]);return(0,n.jsx)(a.Z,{className:"w-".concat(l||7," h-").concat(t||7),component:s()})}},58526:function(e,l,t){var n=t(17402);let r=(0,n.Z)({scriptUrl:"//at.alicdn.com/t/a/font_4440880_ljyggdw605.js"});l.Z=r},46837:function(e,l,t){t.r(l);var n=t(96469),r=t(40789),a=t(26657),o=t(25670),i=t(95838),s=t(51645),c=t(35569),u=t(36980),d=t(26869),f=t.n(d),m=t(38497),v=t(56841),p=t(29828),h=t(68403);let x=e=>{let{value:l,onChange:t,promptList:r}=e,[i,u]=(0,m.useState)(!1),[d,f]=(0,m.useState)(),{t:p}=(0,v.$G)();return(0,m.useEffect)(()=>{if(l){let e=null==r?void 0:r.filter(e=>e.prompt_code===l)[0];f(e)}},[r,l]),(0,n.jsxs)("div",{className:"w-2/5 flex items-center gap-2",children:[(0,n.jsx)(s.default,{className:"w-1/2",placeholder:p("please_select_prompt"),options:r,fieldNames:{label:"prompt_name",value:"prompt_code"},onChange:e=>{let l=null==r?void 0:r.filter(l=>l.prompt_code===e)[0];f(l),null==t||t(e)},value:l,allowClear:!0,showSearch:!0}),d&&(0,n.jsxs)("span",{className:"text-sm text-blue-500 cursor-pointer",onClick:()=>u(!0),children:[(0,n.jsx)(o.Z,{className:"mr-1"}),p("View_details")]}),(0,n.jsx)(c.default,{title:"Prompt ".concat(p("details")),open:i,footer:!1,width:"60%",onCancel:()=>u(!1),children:(0,n.jsx)(a.default,{children:null==d?void 0:d.content})})]})};l.default=e=>{var l,t;let{name:a,initValue:o,modelStrategyOptions:c,resourceTypeOptions:d,updateData:g,classNames:b,promptList:y}=e,{t:j}=(0,v.$G)(),[w]=u.default.useForm(),_=u.default.useWatch("prompt_template",w),C=u.default.useWatch("llm_strategy",w),k=u.default.useWatch("llm_strategy_value",w),Z=(0,m.useMemo)(()=>(null==o?void 0:o.find(e=>e.agent_name===a))||[],[o,a]),N=(0,m.useRef)([]),{run:S,loading:E,data:$}=(0,i.Z)(async()=>{var e;let[,l]=await (0,r.Vx)((0,r.m9)("priority"));return null!==(e=null==l?void 0:l.map(e=>({label:e,value:e})))&&void 0!==e?e:[]},{manual:!0});return(0,m.useEffect)(()=>{"priority"===C&&S()},[S,C]),(0,m.useEffect)(()=>{var e;let l=w.getFieldsValue();g({agent_name:a,...l,llm_strategy_value:null==l?void 0:null===(e=l.llm_strategy_value)||void 0===e?void 0:e.join(","),resources:N.current})},[w,E,a,_,C,k,g]),(0,n.jsx)("div",{className:f()(b),children:(0,n.jsxs)(u.default,{style:{width:"100%"},labelCol:{span:4},form:w,initialValues:{llm_strategy:"default",...Z,llm_strategy_value:null==Z?void 0:null===(l=Z.llm_strategy_value)||void 0===l?void 0:l.split(",")},children:[(0,n.jsx)(u.default.Item,{label:j("Prompt"),name:"prompt_template",children:(0,n.jsx)(x,{promptList:y})}),(0,n.jsx)(u.default.Item,{label:j("LLM_strategy"),required:!0,name:"llm_strategy",children:(0,n.jsx)(s.default,{className:"w-1/5",placeholder:j("please_select_LLM_strategy"),options:c,allowClear:!0})}),"priority"===C&&(0,n.jsx)(u.default.Item,{label:j("LLM_strategy_value"),required:!0,name:"llm_strategy_value",children:(0,n.jsx)(s.default,{mode:"multiple",className:"w-2/5",placeholder:j("please_select_LLM_strategy_value"),options:$,allowClear:!0})}),(0,n.jsx)(u.default.Item,{label:j("available_resources"),name:"resources",children:(0,n.jsx)(h.default,{resourceTypeOptions:d,initValue:null==Z?void 0:null===(t=Z.resources)||void 0===t?void 0:t.map(e=>({...e,uid:(0,p.Z)()})),updateData:e=>{N.current=null==e?void 0:e[1],g({agent_name:a,resources:N.current})},name:a})})]})})}},23464:function(e,l,t){t.r(l);var n=t(96469),r=t(40789),a=t(95838),o=t(36980),i=t(51645),s=t(61076),c=t(26869),u=t.n(c),d=t(38497),f=t(56841);l.default=e=>{let{uid:l,initValue:t,updateData:c,classNames:m,resourceTypeOptions:v,setCurIcon:p}=e,[h]=o.default.useForm(),x=o.default.useWatch("type",h),g=o.default.useWatch("is_dynamic",h),b=o.default.useWatch("value",h),{t:y}=(0,f.$G)(),j=(0,d.useMemo)(()=>(null==v?void 0:v.filter(e=>"all"!==e.value))||[],[v]),{run:w,data:_,loading:C}=(0,a.Z)(async e=>{var l;let[,n]=await (0,r.Vx)((0,r.RX)({type:e}));return h.setFieldsValue({value:(null==t?void 0:t.value)||(null==n?void 0:null===(l=n[0])||void 0===l?void 0:l.key)}),n||[]},{manual:!0});(0,d.useEffect)(()=>{x&&w(x)},[w,x]);let k=(0,d.useMemo)(()=>(null==_?void 0:_.map(e=>({...e,label:e.label,value:e.key+""})))||[],[_]);return(0,d.useEffect)(()=>{let e=h.getFieldsValue(),t=(null==e?void 0:e.is_dynamic)?"":null==e?void 0:e.value;c({uid:l,...e,value:t})},[l,g,h,c,b,x]),(0,n.jsx)("div",{className:u()("flex flex-1",m),children:(0,n.jsxs)(o.default,{style:{width:"100%"},form:h,labelCol:{span:4},initialValues:{...t},children:[(0,n.jsx)(o.default.Item,{label:y("resource_type"),name:"type",children:(0,n.jsx)(i.default,{className:"w-2/5",options:j,onChange:e=>{p({uid:l,icon:e})}})}),(0,n.jsx)(o.default.Item,{label:y("resource_dynamic"),name:"is_dynamic",children:(0,n.jsx)(s.Z,{style:{background:g?"#1677ff":"#ccc"}})}),!g&&(0,n.jsxs)(n.Fragment,{children:[" ","image_file"===x||"internet"===x||["text_file","excel_file"].includes(x)?null:(0,n.jsx)(o.default.Item,{label:y("resource_value"),name:"value",required:!0,children:(0,n.jsx)(i.default,{placeholder:y("please_select_param"),options:k,loading:C,className:"w-3/5",allowClear:!0})})]})]})})}},68403:function(e,l,t){t.r(l),t.d(l,{default:function(){return y}});var n=t(96469),r=t(68840),a=t(26869),o=t.n(a),i=e=>{let{className:l,imgUrl:t="/pictures/empty.png"}=e;return(0,n.jsx)("div",{className:o()("m-auto",{className:l}),children:(0,n.jsx)(r.Z,{image:t,imageStyle:{margin:"0 auto",width:"100%",height:"100%"}})})},s=t(16104),c=t(30606),u=t(51645),d=t(86574),f=t(85815),m=t(75148),v=t(44766),p=t(38497),h=t(56841),x=t(29828),g=t(48044),b=t(23464),y=e=>{var l;let{name:t,updateData:r,resourceTypeOptions:a,initValue:y}=e,{t:j}=(0,h.$G)(),w=(0,p.useRef)(y||[]),[_,C]=(0,p.useState)({uid:"",icon:""}),[k,Z]=(0,p.useState)((null==y?void 0:y.map(e=>({...e,icon:e.type,initVal:e})))||[]),[N,S]=(0,p.useState)([...k]),[E,$]=(0,p.useState)((null==k?void 0:null===(l=k[0])||void 0===l?void 0:l.uid)||""),[O,M]=(0,p.useState)(""),R=(e,l)=>{var n,a;null==e||e.stopPropagation();let o=null===(n=w.current)||void 0===n?void 0:n.findIndex(e=>e.uid===E),i=null==k?void 0:k.filter(e=>e.uid!==l.uid);w.current=w.current.filter(e=>e.uid!==l.uid)||[],r([t,w.current]),Z(i),o===(null==k?void 0:k.length)-1&&0!==o&&setTimeout(()=>{var e;$((null==i?void 0:null===(e=i[i.length-1])||void 0===e?void 0:e.uid)||"")},0),$((null==i?void 0:null===(a=i[o])||void 0===a?void 0:a.uid)||"")};return(0,p.useEffect)(()=>{S([...k])},[k]),(0,p.useEffect)(()=>{Z(k.map(e=>(null==_?void 0:_.uid)===e.uid?{...e,icon:_.icon}:e))},[_]),(0,n.jsxs)("div",{className:"flex flex-1  h-64 px-3 py-4 border border-[#d6d8da] rounded-md",children:[(0,n.jsxs)("div",{className:"flex flex-col w-40 h-full",children:[(0,n.jsx)(u.default,{options:a,className:"w-full h-8",variant:"borderless",defaultValue:"all",onChange:e=>{var l,t;if("all"===e)S(k),$((null==k?void 0:null===(l=k[0])||void 0===l?void 0:l.uid)||"");else{let l=null==k?void 0:k.filter(l=>(null==l?void 0:l.icon)===e);$((null==l?void 0:null===(t=l[0])||void 0===t?void 0:t.uid)||""),S(l)}}}),(0,n.jsx)("div",{className:"flex flex-1 flex-col gap-1 overflow-y-auto",children:null==N?void 0:N.map(e=>(0,n.jsxs)("div",{className:o()("flex h-8 items-center px-3 pl-[0.6rem] rounded-md hover:bg-[#f5faff] hover:dark:bg-[#606264] cursor-pointer relative",{"bg-[#f5faff] dark:bg-[#606264]":e.uid===E}),onClick:()=>{$(e.uid||"")},onMouseEnter:()=>{M(e.uid||"")},onMouseLeave:()=>{M("")},children:[g.resourceTypeIcon[e.icon||""],(0,n.jsx)(d.Z.Text,{className:o()("flex flex-1 items-center text-sm p-0 m-0 mx-2 line-clamp-1",{"text-[#0c75fc]":e.uid===E}),editable:{autoSize:{maxRows:1},onChange:l=>{Z(k.map(t=>t.uid===e.uid?{...t,name:l}:t)),w.current=w.current.map(t=>t.uid===e.uid?{...t,name:l}:t),r([t,w.current])}},ellipsis:{tooltip:!0},children:e.name}),(0,n.jsx)(f.Z,{title:j("want_delete"),onConfirm:l=>{R(l,e)},onCancel:e=>null==e?void 0:e.stopPropagation(),children:(0,n.jsx)(s.Z,{className:"text-sm cursor-pointer  absolute right-2 ".concat(O===e.uid?"opacity-100":"opacity-0"),style:{top:"50%",transform:"translateY(-50%)"},onClick:e=>e.stopPropagation()})})]},e.uid))}),(0,n.jsx)(m.ZP,{className:"w-full h-8",type:"dashed",block:!0,icon:(0,n.jsx)(c.Z,{}),onClick:()=>{var e,l;let n=(0,x.Z)();w.current=(0,v.concat)(w.current,[{is_dynamic:!1,type:null===(e=null==a?void 0:a.filter(e=>"all"!==e.value))||void 0===e?void 0:e[0].value,value:"",uid:n,name:j("resource")+" ".concat(w.current.length+1)}].filter(Boolean)),r([t,w.current]),Z(e=>{var l,t,r;return[...e,{icon:(null===(l=null==a?void 0:a.filter(e=>"all"!==e.value))||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:t.value)||"",uid:n,initVal:{is_dynamic:!1,type:null===(r=null==a?void 0:a.filter(e=>"all"!==e.value))||void 0===r?void 0:r[0].value,value:"",uid:n,name:j("resource")+" ".concat(e.length+1)},name:j("resource")+" ".concat(e.length+1)}]}),$(n),C({uid:n,icon:null===(l=null==a?void 0:a.filter(e=>"all"!==e.value))||void 0===l?void 0:l[0].value})},children:j("add_resource")})]}),(0,n.jsx)("div",{className:"flex flex-1 ml-6 ",children:N&&(null==N?void 0:N.length)>0?(0,n.jsx)("div",{className:"flex flex-1",children:null==N?void 0:N.map(e=>(0,n.jsx)(b.default,{classNames:e.uid===E?"block":"hidden",resourceTypeOptions:a,initValue:e.initVal,setCurIcon:C,updateData:e=>{var l;w.current=null===(l=w.current)||void 0===l?void 0:l.map(l=>(null==l?void 0:l.uid)===(null==e?void 0:e.uid)?{...l,...e}:l),r([t,w.current])},uid:e.uid||""},e.uid))}):(0,n.jsx)(i,{className:"w-40 h-40"})})]})}},48044:function(e,l,t){t.r(l),t.d(l,{agentIcon:function(){return y},resourceTypeIcon:function(){return j}});var n=t(96469),r=t(58526),a=t(80844),o=t(51207),i=t(21347),s=t(40371),c=t(5457),u=t(24504),d=t(69387),f=t(4534),m=t(38042),v=t(69308),p=t(16066),h=t(24025),x=t(31849),g=t(99590),b=t(39603);t(38497);let y={CodeEngineer:(0,n.jsx)(a.Z,{}),Reporter:(0,n.jsx)(o.Z,{}),DataScientist:(0,n.jsx)(i.Z,{}),Summarizer:(0,n.jsx)(s.Z,{}),ToolExpert:(0,n.jsx)(r.Z,{type:"icon-plugin",style:{fontSize:17.25,marginTop:2}}),Indicator:(0,n.jsx)(c.Z,{}),Dbass:(0,n.jsx)(u.Z,{})},j={all:(0,n.jsx)(d.Z,{}),database:(0,n.jsx)(f.Z,{}),knowledge:(0,n.jsx)(m.Z,{}),internet:(0,n.jsx)(v.Z,{}),plugin:(0,n.jsx)(p.Z,{}),text_file:(0,n.jsx)(h.Z,{}),excel_file:(0,n.jsx)(x.Z,{}),image_file:(0,n.jsx)(g.Z,{}),awel_flow:(0,n.jsx)(b.Z,{})};l.default=()=>(0,n.jsx)(n.Fragment,{})},5157:function(e,l,t){t.r(l);var n=t(96469),r=t(67661),a=t(670),o=t(23712),i=t(86574),s=t(93486),c=t.n(s),u=t(38497),d=t(29549);l.default=(0,u.memo)(()=>{var e;let{appInfo:l}=(0,u.useContext)(d.MobileChatContext),{message:t}=o.Z.useApp(),[s,f]=(0,u.useState)(0);if(!(null==l?void 0:l.app_code))return null;let m=async()=>{let e=c()("dingtalk://dingtalkclient/page/link?url=".concat(encodeURIComponent(location.href),"&pc_slide=true"));t[e?"success":"error"](e?"复制成功":"复制失败")};return s>6&&t.info(JSON.stringify(window.navigator.userAgent),2,()=>{f(0)}),(0,n.jsxs)("header",{className:"flex w-full items-center justify-between bg-[rgba(255,255,255,0.9)] border dark:bg-black dark:border-[rgba(255,255,255,0.6)] rounded-xl mx-auto px-4 py-2 mb-4 sticky top-4 z-50 mt-4 shadow-md",children:[(0,n.jsxs)("div",{className:"flex gap-2 items-center",onClick:()=>f(s+1),children:[(0,n.jsx)(r.Z,{scene:(null==l?void 0:null===(e=l.team_context)||void 0===e?void 0:e.chat_scene)||"chat_agent",width:8,height:8}),(0,n.jsxs)("div",{className:"flex flex-col ml-2",children:[(0,n.jsx)(i.Z.Text,{className:"text-md font-bold line-clamp-2",children:null==l?void 0:l.app_name}),(0,n.jsx)(i.Z.Text,{className:"text-sm line-clamp-2",children:null==l?void 0:l.app_describe})]})]}),(0,n.jsx)("div",{onClick:m,className:"flex items-center justify-center w-10 h-10 bg-[#ffffff99] dark:bg-[rgba(255,255,255,0.2)] border border-white dark:border-[rgba(255,255,255,0.2)] rounded-[50%] cursor-pointer",children:(0,n.jsx)(a.Z,{className:"text-lg"})})]})})},86364:function(e,l,t){t.r(l);var n=t(96469),r=t(40789),a=t(7289),o=t(88506),i=t(81736),s=t(48323),c=t(53375),u=t(45766),d=t(96434),f=t(44875),m=t(95838),v=t(86250),p=t(26953),h=t(90885),x=t(6319),g=t(75148),b=t(26869),y=t.n(b),j=t(45875),w=t(38497),_=t(29549),C=t(95433),k=t(14035),Z=t(55238),N=t(75299);let S=["magenta","orange","geekblue","purple","cyan","green"];l.default=()=>{var e,l;let t=(0,j.useSearchParams)(),b=null!==(l=null==t?void 0:t.get("ques"))&&void 0!==l?l:"",{history:E,model:$,scene:O,temperature:M,resource:R,conv_uid:z,appInfo:I,scrollViewRef:V,order:P,userInput:H,ctrl:L,canAbort:T,canNewChat:B,setHistory:A,setCanNewChat:D,setCarAbort:F,setUserInput:W}=(0,w.useContext)(_.MobileChatContext),[q,G]=(0,w.useState)(!1),[J,U]=(0,w.useState)(!1),X=async e=>{var l,t,n;W(""),L.current=new AbortController;let r={chat_mode:O,model_name:$,user_input:e||H,conv_uid:z,temperature:M,app_code:null==I?void 0:I.app_code,...R&&{select_param:JSON.stringify(R)}};if(E&&E.length>0){let e=null==E?void 0:E.filter(e=>"view"===e.role);P.current=e[e.length-1].order+1}let i=[{role:"human",context:e||H,model_name:$,order:P.current,time_stamp:0},{role:"view",context:"",model_name:$,order:P.current,time_stamp:0,thinking:!0}],s=i.length-1;A([...E,...i]),D(!1);try{await (0,f.L)("".concat(null!==(l=N.env.API_BASE_URL)&&void 0!==l?l:"","/api/v1/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json",[o.gp]:null!==(t=(0,a.n5)())&&void 0!==t?t:""},signal:L.current.signal,body:JSON.stringify(r),openWhenHidden:!0,async onopen(e){if(e.ok&&e.headers.get("content-type")===f.a)return},onclose(){var e;null===(e=L.current)||void 0===e||e.abort(),D(!0),F(!1)},onerror(e){throw Error(e)},onmessage:e=>{let l=e.data;try{l=JSON.parse(l).vis}catch(e){l.replaceAll("\\n","\n")}"[DONE]"===l?(D(!0),F(!1)):(null==l?void 0:l.startsWith("[ERROR]"))?(i[s].context=null==l?void 0:l.replace("[ERROR]",""),i[s].thinking=!1,A([...E,...i]),D(!0),F(!1)):(F(!0),i[s].context=l,i[s].thinking=!1,A([...E,...i]))}})}catch(e){null===(n=L.current)||void 0===n||n.abort(),i[s].context="Sorry, we meet some error, please try again later.",i[s].thinking=!1,A([...i]),D(!0),F(!1)}},K=async()=>{H.trim()&&B&&await X()};(0,w.useEffect)(()=>{var e,l;null===(e=V.current)||void 0===e||e.scrollTo({top:null===(l=V.current)||void 0===l?void 0:l.scrollHeight,behavior:"auto"})},[E,V]);let Q=(0,w.useMemo)(()=>{if(!I)return[];let{param_need:e=[]}=I;return null==e?void 0:e.map(e=>e.type)},[I]),Y=(0,w.useMemo)(()=>{var e;return 0===E.length&&I&&!!(null==I?void 0:null===(e=I.recommend_questions)||void 0===e?void 0:e.length)},[E,I]),{run:ee,loading:el}=(0,m.Z)(async()=>await (0,r.Vx)((0,r.zR)(z)),{manual:!0,onSuccess:()=>{A([])}});return(0,w.useEffect)(()=>{b&&$&&z&&I&&X(b)},[I,z,$,b]),(0,n.jsxs)("div",{className:"flex flex-col",children:[Y&&(0,n.jsx)("ul",{children:null==I?void 0:null===(e=I.recommend_questions)||void 0===e?void 0:e.map((e,l)=>(0,n.jsx)("li",{className:"mb-3",children:(0,n.jsx)(v.Z,{color:S[l],className:"p-2 rounded-xl",onClick:async()=>{X(e.question)},children:e.question})},e.id))}),(0,n.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,n.jsxs)("div",{className:"flex gap-2 mb-1 w-full overflow-x-auto",children:[(null==Q?void 0:Q.includes("model"))&&(0,n.jsx)(C.default,{}),(null==Q?void 0:Q.includes("resource"))&&(0,n.jsx)(k.default,{}),(null==Q?void 0:Q.includes("temperature"))&&(0,n.jsx)(Z.default,{})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between text-lg font-bold",children:[(0,n.jsx)(p.Z,{content:"暂停回复",trigger:["hover"],children:(0,n.jsx)(i.Z,{className:y()("p-2 cursor-pointer",{"text-[#0c75fc]":T,"text-gray-400":!T}),onClick:()=>{var e;T&&(null===(e=L.current)||void 0===e||e.abort(),setTimeout(()=>{F(!1),D(!0)},100))}})}),(0,n.jsx)(p.Z,{content:"再来一次",trigger:["hover"],children:(0,n.jsx)(s.Z,{className:y()("p-2 cursor-pointer",{"text-gray-400":!E.length||!B}),onClick:()=>{var e,l;if(!B||0===E.length)return;let t=null===(e=null===(l=E.filter(e=>"human"===e.role))||void 0===l?void 0:l.slice(-1))||void 0===e?void 0:e[0];X((null==t?void 0:t.context)||"")}})}),el?(0,n.jsx)(h.Z,{spinning:el,indicator:(0,n.jsx)(c.Z,{style:{fontSize:18},spin:!0}),className:"p-2"}):(0,n.jsx)(p.Z,{content:"清除历史",trigger:["hover"],children:(0,n.jsx)(u.Z,{className:y()("p-2 cursor-pointer",{"text-gray-400":!E.length||!B}),onClick:()=>{B&&ee()}})})]})]}),(0,n.jsxs)("div",{className:y()("flex py-2 px-3 items-center justify-between bg-white dark:bg-[#242733] dark:border-[#6f7f95] rounded-xl border",{"border-[#0c75fc] dark:border-[rgba(12,117,252,0.8)]":q}),children:[(0,n.jsx)(x.default.TextArea,{placeholder:"可以问我任何问题",className:"w-full resize-none border-0 p-0 focus:shadow-none",value:H,autoSize:{minRows:1},onKeyDown:e=>{if("Enter"===e.key&&!e.shiftKey){if(J){e.preventDefault();return}H.trim()&&(e.preventDefault(),K())}},onChange:e=>{W(e.target.value)},onFocus:()=>{G(!0)},onBlur:()=>G(!1),onCompositionStartCapture:()=>{U(!0)},onCompositionEndCapture:()=>{setTimeout(()=>{U(!1)},0)}}),(0,n.jsx)(g.ZP,{type:"primary",className:y()("flex items-center justify-center rounded-lg bg-button-gradient border-0 ml-2",{"opacity-40 cursor-not-allowed":!H.trim()||!B}),onClick:K,children:B?(0,n.jsx)(d.Z,{}):(0,n.jsx)(h.Z,{indicator:(0,n.jsx)(c.Z,{className:"text-white"})})})]})]})}},95433:function(e,l,t){t.r(l);var n=t(96469),r=t(45277),a=t(61977),o=t(84245),i=t(77295),s=t(26953),c=t(38497),u=t(29549);l.default=()=>{let{modelList:e}=(0,c.useContext)(r.p),{model:l,setModel:t}=(0,c.useContext)(u.MobileChatContext),d=(0,c.useMemo)(()=>e.length>0?e.map(e=>({label:(0,n.jsxs)("div",{className:"flex items-center gap-2",onClick:()=>{t(e)},children:[(0,n.jsx)(a.Z,{width:14,height:14,model:e}),(0,n.jsx)("span",{className:"text-xs",children:e})]}),key:e})):[],[e,t]);return(0,n.jsx)(i.Z,{menu:{items:d},placement:"top",trigger:["click"],children:(0,n.jsx)(s.Z,{content:l,children:(0,n.jsxs)("div",{className:"flex items-center gap-1 border rounded-xl bg-white dark:bg-black p-2 flex-shrink-0",children:[(0,n.jsx)(a.Z,{width:16,height:16,model:l}),(0,n.jsx)("span",{className:"text-xs font-medium line-clamp-1",style:{maxWidth:96},children:l}),(0,n.jsx)(o.Z,{rotate:90})]})})})}},33389:function(e,l,t){t.r(l);var n=t(96469),r=t(23852),a=t.n(r),o=t(38497);l.default=(0,o.memo)(e=>{let{width:l,height:t,src:r,label:o}=e;return(0,n.jsx)(a(),{width:l||14,height:t||14,src:r,alt:o||"db-icon",priority:!0})})},14035:function(e,l,t){t.r(l);var n=t(96469),r=t(40789),a=t(7289),o=t(53375),i=t(84245),s=t(22027),c=t(95838),u=t(90885),d=t(86916),f=t(77295),m=t(38497),v=t(29549),p=t(33389);l.default=()=>{let{appInfo:e,resourceList:l,scene:t,model:h,conv_uid:x,getChatHistoryRun:g,setResource:b,resource:y}=(0,m.useContext)(v.MobileChatContext),[j,w]=(0,m.useState)(null),_=(0,m.useMemo)(()=>{var l,t,n;return null===(l=null==e?void 0:null===(t=e.param_need)||void 0===t?void 0:t.filter(e=>"resource"===e.type))||void 0===l?void 0:null===(n=l[0])||void 0===n?void 0:n.value},[e]),C=(0,m.useMemo)(()=>l&&l.length>0?l.map(e=>({label:(0,n.jsxs)("div",{className:"flex items-center gap-2",onClick:()=>{w(e),b(e.space_id||e.param)},children:[(0,n.jsx)(p.default,{width:14,height:14,src:a.S$[e.type].icon,label:a.S$[e.type].label}),(0,n.jsx)("span",{className:"text-xs",children:e.param})]}),key:e.space_id||e.param})):[],[l,b]),{run:k,loading:Z}=(0,c.Z)(async e=>{let[,l]=await (0,r.Vx)((0,r.qn)({convUid:x,chatMode:t,data:e,model:h,config:{timeout:36e5}}));return b(l),l},{manual:!0,onSuccess:async()=>{await g()}}),N=async e=>{let l=new FormData;l.append("doc_file",null==e?void 0:e.file),await k(l)},S=(0,m.useMemo)(()=>Z?(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(u.Z,{size:"small",indicator:(0,n.jsx)(o.Z,{spin:!0})}),(0,n.jsx)("span",{className:"text-xs",children:"上传中"})]}):y?(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)("span",{className:"text-xs",children:y.file_name}),(0,n.jsx)(i.Z,{rotate:90})]}):(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(s.Z,{className:"text-base"}),(0,n.jsx)("span",{className:"text-xs",children:"上传文件"})]}),[Z,y]);return(0,n.jsx)(n.Fragment,{children:(()=>{switch(_){case"excel_file":case"text_file":case"image_file":return(0,n.jsx)("div",{className:"flex items-center justify-center gap-1 border rounded-xl bg-white dark:bg-black px-2 flex-shrink-0",children:(0,n.jsx)(d.default,{name:"file",accept:".xlsx,.xls",maxCount:1,showUploadList:!1,beforeUpload:()=>!1,onChange:N,className:"flex h-full w-full items-center justify-center",children:S})});case"database":case"knowledge":case"plugin":case"awel_flow":var e,t,r,o,s;if(!(null==l?void 0:l.length))return null;return(0,n.jsx)(f.Z,{menu:{items:C},placement:"top",trigger:["click"],children:(0,n.jsxs)("div",{className:"flex items-center gap-1 border rounded-xl bg-white dark:bg-black p-2 flex-shrink-0",children:[(0,n.jsx)(p.default,{width:14,height:14,src:null===(e=a.S$[(null==j?void 0:j.type)||(null==l?void 0:null===(t=l[0])||void 0===t?void 0:t.type)])||void 0===e?void 0:e.icon,label:null===(r=a.S$[(null==j?void 0:j.type)||(null==l?void 0:null===(o=l[0])||void 0===o?void 0:o.type)])||void 0===r?void 0:r.label}),(0,n.jsx)("span",{className:"text-xs font-medium",children:(null==j?void 0:j.param)||(null==l?void 0:null===(s=l[0])||void 0===s?void 0:s.param)}),(0,n.jsx)(i.Z,{rotate:90})]})})}})()})}},55238:function(e,l,t){t.r(l);var n=t(96469),r=t(58526),a=t(77295),o=t(45642),i=t(38497),s=t(29549);l.default=()=>{let{temperature:e,setTemperature:l}=(0,i.useContext)(s.MobileChatContext),t=e=>{isNaN(e)||l(e)};return(0,n.jsx)(a.Z,{trigger:["click"],dropdownRender:()=>(0,n.jsx)("div",{className:"flex h-28 bg-white dark:bg-[rgba(255,255,255,0.5)] items-center justify-center rounded-xl py-3",children:(0,n.jsx)(o.Z,{defaultValue:.5,max:1,min:0,step:.1,vertical:!0,onChange:t,value:e})}),placement:"top",children:(0,n.jsxs)("div",{className:"flex items-center justify-between border rounded-xl bg-white dark:bg-black w-14 p-2 flex-shrink-0",children:[(0,n.jsx)(r.Z,{type:"icon-icons-temperature",className:"text-sm"}),(0,n.jsx)("span",{className:"text-xs font-medium",children:e})]})})}},29549:function(e,l,t){t.r(l),t.d(l,{MobileChatContext:function(){return y}});var n=t(96469),r=t(45277),a=t(40789),o=t(51310),i=t(7289),s=t(88506),c=t(44875),u=t(95838),d=t(90885),f=t(28469),m=t.n(f),v=t(45875),p=t(38497),h=t(5157),x=t(86364),g=t(75299);let b=m()(()=>Promise.all([t.e(7521),t.e(6881),t.e(1645),t.e(1233),t.e(6279),t.e(5462),t.e(2592),t.e(669),t.e(5137),t.e(7352),t.e(8149),t.e(2533),t.e(9212),t.e(1198),t.e(2834),t.e(1935),t.e(5891),t.e(5859),t.e(7270)]).then(t.bind(t,33068)),{loadableGenerated:{webpack:()=>[33068]},ssr:!1}),y=(0,p.createContext)({model:"",temperature:.5,resource:null,setModel:()=>{},setTemperature:()=>{},setResource:()=>{},scene:"",history:[],setHistory:()=>{},scrollViewRef:{current:null},appInfo:{},conv_uid:"",resourceList:[],order:{current:1},handleChat:()=>Promise.resolve(),canAbort:!1,setCarAbort:()=>{},canNewChat:!1,setCanNewChat:()=>{},ctrl:{current:void 0},userInput:"",setUserInput:()=>{},getChatHistoryRun:()=>{}});l.default=()=>{var e,l;let t=(0,v.useSearchParams)(),f=null!==(e=null==t?void 0:t.get("chat_scene"))&&void 0!==e?e:"",m=null!==(l=null==t?void 0:t.get("app_code"))&&void 0!==l?l:"",{modelList:j}=(0,p.useContext)(r.p),[w,_]=(0,p.useState)([]),[C,k]=(0,p.useState)(""),[Z,N]=(0,p.useState)(.5),[S,E]=(0,p.useState)(null),$=(0,p.useRef)(null),[O,M]=(0,p.useState)(""),[R,z]=(0,p.useState)(!1),[I,V]=(0,p.useState)(!0),P=(0,p.useRef)(),H=(0,p.useRef)(1),L=(0,o.Z)(),T=(0,p.useMemo)(()=>"".concat(null==L?void 0:L.user_no,"_").concat(m),[m,L]),{run:B,loading:A}=(0,u.Z)(async()=>await (0,a.Vx)((0,a.$i)("".concat(null==L?void 0:L.user_no,"_").concat(m))),{manual:!0,onSuccess:e=>{let[,l]=e,t=null==l?void 0:l.filter(e=>"view"===e.role);t&&t.length>0&&(H.current=t[t.length-1].order+1),_(l||[])}}),{data:D,run:F,loading:W}=(0,u.Z)(async e=>{let[,l]=await (0,a.Vx)((0,a.BN)(e));return null!=l?l:{}},{manual:!0}),{run:q,data:G,loading:J}=(0,u.Z)(async()=>{var e,l;let[,t]=await (0,a.Vx)((0,a.vD)(f));return E((null==t?void 0:null===(e=t[0])||void 0===e?void 0:e.space_id)||(null==t?void 0:null===(l=t[0])||void 0===l?void 0:l.param)),null!=t?t:[]},{manual:!0}),{run:U,loading:X}=(0,u.Z)(async()=>{let[,e]=await (0,a.Vx)((0,a.iP)());return null!=e?e:[]},{manual:!0,onSuccess:e=>{var l;let t=null===(l=null==e?void 0:e.filter(e=>e.conv_uid===T))||void 0===l?void 0:l[0];(null==t?void 0:t.select_param)&&E(JSON.parse(null==t?void 0:t.select_param))}});(0,p.useEffect)(()=>{f&&m&&j.length&&F({chat_scene:f,app_code:m})},[m,f,F,j]),(0,p.useEffect)(()=>{m&&B()},[m]),(0,p.useEffect)(()=>{if(j.length>0){var e,l,t;let n=null===(e=null==D?void 0:null===(l=D.param_need)||void 0===l?void 0:l.filter(e=>"model"===e.type))||void 0===e?void 0:null===(t=e[0])||void 0===t?void 0:t.value;k(n||j[0])}},[j,D]),(0,p.useEffect)(()=>{var e,l,t;let n=null===(e=null==D?void 0:null===(l=D.param_need)||void 0===l?void 0:l.filter(e=>"temperature"===e.type))||void 0===e?void 0:null===(t=e[0])||void 0===t?void 0:t.value;N(n||.5)},[D]),(0,p.useEffect)(()=>{if(f&&(null==D?void 0:D.app_code)){var e,l,t,n,r,a;let o=null===(e=null==D?void 0:null===(l=D.param_need)||void 0===l?void 0:l.filter(e=>"resource"===e.type))||void 0===e?void 0:null===(t=e[0])||void 0===t?void 0:t.value,i=null===(n=null==D?void 0:null===(r=D.param_need)||void 0===r?void 0:r.filter(e=>"resource"===e.type))||void 0===n?void 0:null===(a=n[0])||void 0===a?void 0:a.bind_value;i&&E(i),["database","knowledge","plugin","awel_flow"].includes(o)&&!i&&q()}},[D,f,q]);let K=async e=>{var l,t,n;M(""),P.current=new AbortController;let r={chat_mode:f,model_name:C,user_input:e||O,conv_uid:T,temperature:Z,app_code:null==D?void 0:D.app_code,...S&&{select_param:S}};if(w&&w.length>0){let e=null==w?void 0:w.filter(e=>"view"===e.role);H.current=e[e.length-1].order+1}let a=[{role:"human",context:e||O,model_name:C,order:H.current,time_stamp:0},{role:"view",context:"",model_name:C,order:H.current,time_stamp:0,thinking:!0}],o=a.length-1;_([...w,...a]),V(!1);try{await (0,c.L)("".concat(null!==(l=g.env.API_BASE_URL)&&void 0!==l?l:"","/api/v1/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json",[s.gp]:null!==(t=(0,i.n5)())&&void 0!==t?t:""},signal:P.current.signal,body:JSON.stringify(r),openWhenHidden:!0,async onopen(e){if(e.ok&&e.headers.get("content-type")===c.a)return},onclose(){var e;null===(e=P.current)||void 0===e||e.abort(),V(!0),z(!1)},onerror(e){throw Error(e)},onmessage:e=>{let l=e.data;try{l=JSON.parse(l).vis}catch(e){l.replaceAll("\\n","\n")}"[DONE]"===l?(V(!0),z(!1)):(null==l?void 0:l.startsWith("[ERROR]"))?(a[o].context=null==l?void 0:l.replace("[ERROR]",""),a[o].thinking=!1,_([...w,...a]),V(!0),z(!1)):(z(!0),a[o].context=l,a[o].thinking=!1,_([...w,...a]))}})}catch(e){null===(n=P.current)||void 0===n||n.abort(),a[o].context="Sorry, we meet some error, please try again later.",a[o].thinking=!1,_([...a]),V(!0),z(!1)}};return(0,p.useEffect)(()=>{f&&"chat_agent"!==f&&U()},[f,U]),(0,n.jsx)(y.Provider,{value:{model:C,resource:S,setModel:k,setTemperature:N,setResource:E,temperature:Z,appInfo:D,conv_uid:T,scene:f,history:w,scrollViewRef:$,setHistory:_,resourceList:G,order:H,handleChat:K,setCanNewChat:V,ctrl:P,canAbort:R,setCarAbort:z,canNewChat:I,userInput:O,setUserInput:M,getChatHistoryRun:B},children:(0,n.jsx)(d.Z,{size:"large",className:"flex h-screen w-screen justify-center items-center max-h-screen",spinning:A||W||J||X,children:(0,n.jsxs)("div",{className:"flex flex-col h-screen bg-gradient-light dark:bg-gradient-dark p-4 pt-0",children:[(0,n.jsxs)("div",{ref:$,className:"flex flex-col flex-1 overflow-y-auto mb-3",children:[(0,n.jsx)(h.default,{}),(0,n.jsx)(b,{})]}),(null==D?void 0:D.app_code)&&(0,n.jsx)(x.default,{})]})})})}}}]);